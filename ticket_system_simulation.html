<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¥¨åŠ¡ç³»ç»Ÿæ¨¡æ‹Ÿå™¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'å¾®è½¯é›…é»‘', Arial, sans-serif;
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
        }

        /* ä¸»å®¹å™¨ */
        .main-container {
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* ä¾§è¾¹æ  */
        .sidebar {
            width: 280px;
            background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }

        .logo {
            display: flex;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .logo-icon {
            font-size: 32px;
            margin-right: 10px;
        }

        .logo-text {
            font-size: 20px;
            font-weight: bold;
        }

        .nav-section {
            margin-bottom: 30px;
        }

        .nav-section h3 {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            opacity: 0.8;
            padding-left: 10px;
        }

        .nav-menu {
            list-style: none;
        }

        .nav-item {
            margin-bottom: 5px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
            opacity: 0.8;
        }

        .nav-link:hover {
            background-color: rgba(255,255,255,0.2);
            opacity: 1;
            transform: translateX(5px);
        }

        .nav-link.active {
            background-color: rgba(255,255,255,0.3);
            opacity: 1;
            font-weight: bold;
        }

        .nav-icon {
            margin-right: 12px;
            font-size: 18px;
        }

        /* ä¸»å†…å®¹åŒºåŸŸ */
        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* é¡¶éƒ¨å¯¼èˆªæ  */
        .top-nav {
            background-color: white;
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 100;
        }

        .nav-title {
            font-size: 20px;
            font-weight: bold;
            color: #667eea;
        }

        .nav-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* é¡µé¢å†…å®¹ */
        .page-content {
            flex: 1;
            padding: 25px;
            overflow-y: auto;
        }

        /* å¡ç‰‡æ ·å¼ */
        .card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            padding: 25px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }

        .card-title {
            font-size: 20px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background-color: #f0f0ff;
            color: #667eea;
        }

        .btn-secondary:hover {
            background-color: #e0e0ff;
        }

        .btn-success {
            background-color: #4CAF50;
            color: white;
        }

        .btn-success:hover {
            background-color: #45a049;
        }

        .btn-danger {
            background-color: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background-color: #c82333;
        }

        /* è¡¨å•æ ·å¼ */
        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: #667eea;
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* é”€å”®é˜¶æ®µæ ·å¼ */
        .sales-phases {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        .phase {
            background-color: white;
            border-radius: 6px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #dee2e6;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .phase:last-child {
            margin-bottom: 0;
        }

        .phase-header h4 {
            margin: 0 0 15px 0;
            color: #495057;
            font-size: 16px;
            font-weight: 600;
        }

        .phase .form-row {
            margin-bottom: 10px;
        }

        .phase .form-row:last-child {
            margin-bottom: 0;
        }

        /* æ ‡ç­¾æ ·å¼ */
        .tag {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-right: 8px;
            margin-bottom: 8px;
        }

        .tag-success {
            background-color: #d4edda;
            color: #155724;
        }

        .tag-warning {
            background-color: #fff3cd;
            color: #856404;
        }

        .tag-danger {
            background-color: #f8d7da;
            color: #721c24;
        }

        .tag-info {
            background-color: #d1ecf1;
            color: #0c5460;
        }

        /* è¡¨æ ¼æ ·å¼ */
        .table-container {
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th,
        .data-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .data-table th {
            background-color: #f8f9fa;
            font-weight: bold;
            color: #555;
        }

        .data-table tr:hover {
            background-color: #f8f9fa;
        }

        /* ä»ªè¡¨ç›˜æ ·å¼ */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 36px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 16px;
            opacity: 0.9;
        }

        /* åº§ä½å›¾æ ·å¼ */
        .seat-map-container {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .seat-map {
            position: relative;
            width: 100%;
            height: 400px;
            background-color: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .stage {
            width: 80%;
            height: 60px;
            background-color: #333;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 30px;
            border-radius: 8px;
        }

        .seat-section {
            margin-bottom: 20px;
        }

        .seat-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            justify-content: center;
        }

        .seat {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .seat.available {
            background-color: #4CAF50;
            color: white;
        }

        .seat.available:hover {
            transform: scale(1.1);
            background-color: #45a049;
        }

        .seat.selected {
            background-color: #667eea;
            color: white;
            transform: scale(1.1);
        }

        .seat.sold {
            background-color: #dc3545;
            color: white;
            cursor: not-allowed;
        }

        .seat.locked {
            background-color: #ffc107;
            color: white;
            cursor: not-allowed;
        }

        /* åº“å­˜æ± æ ·å¼ */
        .inventory-pool {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .inventory-card {
            background-color: white;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }

        .inventory-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }

        .inventory-value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .inventory-value.total {
            color: #667eea;
        }

        .inventory-value.available {
            color: #4CAF50;
        }

        .inventory-value.locked {
            color: #ffc107;
        }

        .inventory-value.sold {
            color: #dc3545;
        }

        /* å›¾è¡¨å®¹å™¨ */
        .chart-container {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                max-height: 200px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .nav-actions {
                flex-direction: column;
                gap: 10px;
            }
        }

        /* éšè—å†…å®¹ */
        .hidden {
            display: none !important;
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 50px;
            color: #667eea;
        }

        .spinner {
            border: 4px solid rgba(102, 126, 234, 0.3);
            border-radius: 50%;
            border-top: 4px solid #667eea;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin-right: 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* æ¶ˆæ¯æç¤º */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
        }

        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }

        .toast.success {
            background-color: #4CAF50;
        }

        .toast.error {
            background-color: #dc3545;
        }

        .toast.warning {
            background-color: #ffc107;
            color: #333;
        }

        /* æ¨¡æ€æ¡†æ ·å¼ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            transform: scale(0.9);
            transition: transform 0.3s ease;
        }

        .modal.show .modal-content {
            transform: scale(1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        /* æŒ‰é’®ç»„ */
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        /* å·¥å…·æç¤º */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <!-- ä¸»å®¹å™¨ -->
    <div class="main-container">
        <!-- ä¾§è¾¹æ  -->
        <aside class="sidebar">
            <div class="logo">
                <div class="logo-icon">ğŸŸï¸</div>
                <div class="logo-text">ç¥¨åŠ¡ç³»ç»Ÿ</div>
            </div>

            <nav>
                <div class="nav-section">
                    <h3>åå°ç®¡ç†</h3>
                    <ul class="nav-menu">
                        <li class="nav-item">
                            <a href="#" class="nav-link active" onclick="showPage('dashboard')">
                                <div class="nav-icon">ğŸ“Š</div>
                                <span>æ•°æ®ä»ªè¡¨ç›˜</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" onclick="showPage('createEvent')">
                                <div class="nav-icon">ğŸ¨</div>
                                <span>åˆ›å»ºæ´»åŠ¨</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" onclick="showPage('inventory')">
                                <div class="nav-icon">ğŸ“¦</div>
                                <span>åº“å­˜ç®¡ç†</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" onclick="showPage('sales')">
                                <div class="nav-icon">ğŸ’°</div>
                                <span>é”€å”®æ§åˆ¶</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" onclick="showPage('verification')">
                                <div class="nav-icon">âœ…</div>
                                <span>ç¥¨åŠ¡æ ¸é”€</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link" onclick="showPage('reports')">
                                <div class="nav-icon">ğŸ“ˆ</div>
                                <span>é”€å”®æŠ¥è¡¨</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="nav-section">
                    <h3>å‰ç«¯è´­ç¥¨</h3>
                    <ul class="nav-menu">
                        <li class="nav-item">
                            <a href="#" class="nav-link" onclick="showPage('customerPortal')">
                                <div class="nav-icon">ğŸ‘¤</div>
                                <span>å®¢æˆ·è´­ç¥¨é¡µ</span>
                            </a>
                        </li>
                    </ul>
                </div>

                <div class="nav-section">
                    <h3>ç³»ç»Ÿè®¾ç½®</h3>
                    <ul class="nav-menu">
                        <li class="nav-item">
                            <a href="#" class="nav-link" onclick="showPage('settings')">
                                <div class="nav-icon">âš™ï¸</div>
                                <span>ç³»ç»Ÿè®¾ç½®</span>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </aside>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <div class="content">
            <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
            <header class="top-nav">
                <div class="nav-title">
                    <span id="pageTitle">æ•°æ®ä»ªè¡¨ç›˜</span>
                </div>
                <div class="nav-actions">
                    <div class="user-info">
                        <span>ç®¡ç†å‘˜</span>
                        <div style="width: 40px; height: 40px; border-radius: 50%; background-color: #667eea; color: white; display: flex; align-items: center; justify-content: center; font-weight: bold;">
                            AD
                        </div>
                    </div>
                </div>
            </header>

            <!-- é¡µé¢å†…å®¹ -->
            <main class="page-content">
                <!-- æ•°æ®ä»ªè¡¨ç›˜ -->
                <div id="dashboard" class="page">
                    <div class="dashboard-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="totalEvents">12</div>
                            <div class="stat-label">æ€»æ´»åŠ¨æ•°</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalSales">Â¥285,600</div>
                            <div class="stat-label">ç´¯è®¡é”€å”®é¢</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="totalTickets">8,640</div>
                            <div class="stat-label">æ€»å”®å‡ºç¥¨æ•°</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="currentSpeed">12å¼ /å°æ—¶</div>
                            <div class="stat-label">å®æ—¶é”€å”®é€Ÿåº¦</div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-title">ğŸ“Š é”€å”®æ•°æ®æ¦‚è§ˆ</div>
                        <div class="chart-container">
                            <canvas id="salesChart" width="400" height="200"></canvas>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-title">ğŸŸï¸ ç¥¨ç§é”€å”®å æ¯”</div>
                        <div class="chart-container">
                            <canvas id="ticketTypeChart" width="400" height="200"></canvas>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-title">ğŸŸï¸ æ´»åŠ¨åˆ—è¡¨</div>
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>æ´»åŠ¨åç§°</th>
                                        <th>æ—¶é—´</th>
                                        <th>åœ°ç‚¹</th>
                                        <th>çŠ¶æ€</th>
                                        <th>é”€å”®é¢</th>
                                        <th>æ“ä½œ</th>
                                    </tr>
                                </thead>
                                <tbody id="eventList">
                                    <!-- æ´»åŠ¨åˆ—è¡¨å°†åŠ¨æ€æ·»åŠ  -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- åˆ›å»ºæ´»åŠ¨é¡µé¢ -->
                <div id="createEvent" class="page hidden">
                    <div class="card">
                        <div class="card-title">ğŸ¨ åˆ›å»ºæ–°æ´»åŠ¨</div>
                        <form id="eventForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="eventName">æ´»åŠ¨åç§°</label>
                                    <input type="text" id="eventName" placeholder="è¯·è¾“å…¥æ´»åŠ¨åç§°" required>
                                </div>
                                <div class="form-group">
                                    <label for="eventDate">æ´»åŠ¨æ—¶é—´</label>
                                    <input type="datetime-local" id="eventDate" required>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="eventLocation">æ´»åŠ¨åœ°ç‚¹</label>
                                    <input type="text" id="eventLocation" placeholder="è¯·è¾“å…¥æ´»åŠ¨åœ°ç‚¹" required>
                                </div>
                                <div class="form-group">
                                    <label for="eventPoster">æ´»åŠ¨æµ·æŠ¥</label>
                                    <input type="file" id="eventPoster" accept="image/*">
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="ticketType">ç¥¨ç§ç±»å‹</label>
                                    <select id="ticketType" required>
                                        <option value="">è¯·é€‰æ‹©ç¥¨ç§ç±»å‹</option>
                                        <option value="free">è‡ªç”±ç¥¨ï¼ˆæ— å›ºå®šåº§ä½ï¼‰</option>
                                        <option value="seat">åº§ä½ç¥¨</option>
                                    </select>
                                </div>
                            </div>

                            <!-- åˆ†é˜¶æ®µé”€å”®è®¾ç½® -->
                            <div class="form-group">
                                <label>é”€å”®é˜¶æ®µè®¾ç½®</label>
                                <div class="sales-phases">
                                    <div class="phase">
                                        <div class="phase-header">
                                            <h4>æ—©é¸Ÿç¥¨é˜¶æ®µ</h4>
                                            <div class="form-row">
                                                <div class="form-group">
                                                    <label for="earlyBirdStart">å¼€å§‹æ—¶é—´</label>
                                                    <input type="datetime-local" id="earlyBirdStart" required>
                                                </div>
                                                <div class="form-group">
                                                    <label for="earlyBirdEnd">ç»“æŸæ—¶é—´</label>
                                                    <input type="datetime-local" id="earlyBirdEnd" required>
                                                </div>
                                                <div class="form-group">
                                                    <label for="earlyBirdPrice">æ—©é¸Ÿç¥¨ä»· (Â¥)</label>
                                                    <input type="number" id="earlyBirdPrice" value="80" min="0" step="0.01" required>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="phase">
                                        <div class="phase-header">
                                            <h4>æ™®é€šç¥¨é˜¶æ®µ</h4>
                                            <div class="form-row">
                                                <div class="form-group">
                                                    <label for="regularStart">å¼€å§‹æ—¶é—´</label>
                                                    <input type="datetime-local" id="regularStart" required>
                                                </div>
                                                <div class="form-group">
                                                    <label for="regularEnd">ç»“æŸæ—¶é—´</label>
                                                    <input type="datetime-local" id="regularEnd" required>
                                                </div>
                                                <div class="form-group">
                                                    <label for="regularPrice">æ™®é€šç¥¨ä»· (Â¥)</label>
                                                    <input type="number" id="regularPrice" value="100" min="0" step="0.01" required>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="maxPerUser">æ¯äººé™è´­</label>
                                    <input type="number" id="maxPerUser" value="1" min="1" max="10">
                                </div>
                            </div>

                            <!-- è‡ªç”±ç¥¨è®¾ç½® -->
                            <div id="freeTicketSettings" class="hidden">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="freeTotalInventory">æ€»åº“å­˜</label>
                                        <input type="number" id="freeTotalInventory" value="100" min="1" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="freePrice">ç¥¨ä»· (Â¥)</label>
                                        <input type="number" id="freePrice" value="100" min="0" step="0.01" required>
                                    </div>
                                </div>
                            </div>

                            <!-- åº§ä½ç¥¨è®¾ç½® -->
                            <div id="seatTicketSettings" class="hidden">
                                <div class="form-group">
                                    <label>åº§ä½å›¾è®¾ç½®</label>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label for="seatMapUpload">ä¸Šä¼ åº§ä½å›¾ (SVG/PNG/JPG)</label>
                                            <input type="file" id="seatMapUpload" accept=".svg,.png,.jpg,.jpeg" onchange="previewSeatMap(this)">
                                            <p style="color: #666; font-size: 12px; margin-top: 5px;">
                                                å»ºè®®ä¸Šä¼ SVGæ ¼å¼ä»¥è·å¾—æœ€ä½³æ•ˆæœ
                                            </p>
                                        </div>
                                        <div class="form-group">
                                            <label>åº§ä½å›¾é¢„è§ˆ</label>
                                            <div style="margin-top: 10px;">
                                                <button type="button" class="btn btn-primary" onclick="loadSampleSeatMap()">
                                                    åŠ è½½ç¤ºä¾‹åº§ä½å›¾
                                                </button>
                                                <button type="button" class="btn btn-secondary" onclick="clearSeatMap()">
                                                    æ¸…é™¤åº§ä½å›¾
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="seat-map-container">
                                        <div class="seat-map" id="seatMap">
                                            <div class="stage">èˆå°</div>
                                            <div class="seat-section">
                                                <!-- åº§ä½å›¾å°†åŠ¨æ€ç”Ÿæˆ -->
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="seatSection">åŒºåŸŸåç§°</label>
                                        <input type="text" id="seatSection" placeholder="ä¾‹å¦‚ï¼šAåŒºã€VIPåŒº" value="AåŒº">
                                    </div>
                                    <div class="form-group">
                                        <label for="seatPrice">åŒºåŸŸç¥¨ä»· (Â¥)</label>
                                        <input type="number" id="seatPrice" value="200" min="0" step="0.01" required>
                                    </div>
                                </div>
                            </div>

                            <div class="btn-group">
                                <button type="submit" class="btn btn-primary">åˆ›å»ºæ´»åŠ¨</button>
                                <button type="button" class="btn btn-secondary" onclick="batchImportEvents()">æ‰¹é‡å¯¼å…¥</button>
                                <button type="button" class="btn btn-secondary" onclick="resetForm()">é‡ç½®</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- åº“å­˜ç®¡ç†é¡µé¢ -->
                <div id="inventory" class="page hidden">
                    <div class="card">
                        <div class="card-title">ğŸ“¦ åº“å­˜ç®¡ç†</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="inventoryEvent">é€‰æ‹©æ´»åŠ¨</label>
                                <select id="inventoryEvent" required>
                                    <option value="">è¯·é€‰æ‹©æ´»åŠ¨</option>
                                    <option value="1">å‘¨æ°ä¼¦æ¼”å”±ä¼š</option>
                                    <option value="2">äº”æœˆå¤©æ¼”å”±ä¼š</option>
                                    <option value="3">å­™ç‡•å§¿æ¼”å”±ä¼š</option>
                                </select>
                            </div>
                        </div>

                        <!-- è‡ªç”±åº“å­˜æ¨¡å¼ -->
                        <div id="freeInventoryPanel">
                            <div class="card">
                                <div class="card-title">è‡ªç”±åº“å­˜æ¨¡å¼</div>
                                <div class="inventory-pool">
                                    <div class="inventory-card">
                                        <div class="inventory-label">æ€»åº“å­˜</div>
                                        <div class="inventory-value total">1000</div>
                                        <input type="range" min="0" max="2000" value="1000" class="slider" id="totalInventorySlider">
                                    </div>
                                    <div class="inventory-card">
                                        <div class="inventory-label">å¯å”®ç¥¨æ•°</div>
                                        <div class="inventory-value available">780</div>
                                    </div>
                                    <div class="inventory-card">
                                        <div class="inventory-label">é”å®šç¥¨æ•°</div>
                                        <div class="inventory-value locked">45</div>
                                    </div>
                                    <div class="inventory-card">
                                        <div class="inventory-label">å·²å”®ç¥¨æ•°</div>
                                        <div class="inventory-value sold">175</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- åº§ä½åº“å­˜æ¨¡å¼ -->
                        <div id="seatInventoryPanel">
                            <div class="card">
                                <div class="card-title">åº§ä½åº“å­˜æ¨¡å¼</div>
                                <div class="seat-map-container">
                                    <div class="seat-map">
                                        <div class="stage">èˆå°</div>
                                        <div class="seat-section">
                                            <div class="seat-row">
                                                <div class="seat available">VIP1</div>
                                                <div class="seat sold">VIP2</div>
                                                <div class="seat available">VIP3</div>
                                                <div class="seat locked">VIP4</div>
                                                <div class="seat available">VIP5</div>
                                            </div>
                                            <div class="seat-row">
                                                <div class="seat available">A1</div>
                                                <div class="seat available">A2</div>
                                                <div class="seat sold">A3</div>
                                                <div class="seat available">A4</div>
                                                <div class="seat available">A5</div>
                                            </div>
                                            <div class="seat-row">
                                                <div class="seat available">B1</div>
                                                <div class="seat sold">B2</div>
                                                <div class="seat sold">B3</div>
                                                <div class="seat available">B4</div>
                                                <div class="seat locked">B5</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="seatStatusFilter">åº§ä½çŠ¶æ€</label>
                                        <select id="seatStatusFilter">
                                            <option value="">å…¨éƒ¨</option>
                                            <option value="available">å¯å”®</option>
                                            <option value="sold">å·²å”®</option>
                                            <option value="locked">é”å®š</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="seatSectionFilter">åŒºåŸŸç­›é€‰</label>
                                        <select id="seatSectionFilter">
                                            <option value="">å…¨éƒ¨åŒºåŸŸ</option>
                                            <option value="VIP">VIPåŒº</option>
                                            <option value="A">AåŒº</option>
                                            <option value="B">BåŒº</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- é”€å”®æ§åˆ¶é¡µé¢ -->
                <div id="sales" class="page hidden">
                    <div class="card">
                        <div class="card-title">ğŸ’° é”€å”®æ§åˆ¶é¢æ¿</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="salesEvent">é€‰æ‹©æ´»åŠ¨</label>
                                <select id="salesEvent" required>
                                    <option value="">è¯·é€‰æ‹©æ´»åŠ¨</option>
                                    <option value="1">å‘¨æ°ä¼¦æ¼”å”±ä¼š</option>
                                    <option value="2">äº”æœˆå¤©æ¼”å”±ä¼š</option>
                                </select>
                            </div>
                        </div>

                        <!-- å½“å‰é”€å”®é˜¶æ®µä¿¡æ¯ -->
                        <div class="card">
                            <div class="card-title">ğŸ“Š å½“å‰é”€å”®é˜¶æ®µä¿¡æ¯</div>
                            <div id="currentSalesPhaseInfo" style="padding: 20px; background-color: #f8f9fa; border-radius: 8px;">
                                <p style="color: #666; text-align: center;">è¯·å…ˆé€‰æ‹©ä¸€ä¸ªæ´»åŠ¨æŸ¥çœ‹å½“å‰é”€å”®é˜¶æ®µä¿¡æ¯</p>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-title">åˆ†é˜¶æ®µé”€å”®è®¾ç½®</div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="earlyBirdStart">æ—©é¸Ÿç¥¨å¼€å§‹æ—¶é—´</label>
                                    <input type="datetime-local" id="earlyBirdStart">
                                </div>
                                <div class="form-group">
                                    <label for="earlyBirdEnd">æ—©é¸Ÿç¥¨ç»“æŸæ—¶é—´</label>
                                    <input type="datetime-local" id="earlyBirdEnd">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="earlyBirdPrice">æ—©é¸Ÿç¥¨ä»·æ ¼ (Â¥)</label>
                                    <input type="number" id="earlyBirdPrice" value="180" min="0" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label for="regularPrice">æ™®é€šç¥¨ä»·æ ¼ (Â¥)</label>
                                    <input type="number" id="regularPrice" value="280" min="0" step="0.01">
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-title">é™è´­ä¸é˜²åˆ·è®¾ç½®</div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="maxTicketsPerUser">æ¯ä¸ªè´¦æˆ·é™è´­</label>
                                    <input type="number" id="maxTicketsPerUser" value="4" min="1" max="10">
                                </div>
                                <div class="form-group">
                                    <label for="maxTicketsPerPhone">æ¯ä¸ªæ‰‹æœºå·é™è´­</label>
                                    <input type="number" id="maxTicketsPerPhone" value="4" min="1" max="10">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="antiBrushEnabled">å¯ç”¨é˜²åˆ·æœºåˆ¶</label>
                                    <input type="checkbox" id="antiBrushEnabled" checked>
                                </div>
                                <div class="form-group">
                                    <label for="requestLimit">IPè¯·æ±‚é™åˆ¶ (æ¬¡/åˆ†é’Ÿ)</label>
                                    <input type="number" id="requestLimit" value="10" min="1">
                                </div>
                            </div>
                        </div>

                        <div class="btn-group">
                            <button type="button" class="btn btn-primary" onclick="saveSalesSettings()">ä¿å­˜è®¾ç½®</button>
                            <button type="button" class="btn btn-secondary" onclick="resetSalesSettings()">é‡ç½®</button>
                        </div>
                    </div>
                </div>

                <!-- ç¥¨åŠ¡æ ¸é”€é¡µé¢ -->
                <div id="verification" class="page hidden">
                    <div class="card">
                        <div class="card-title">âœ… ç¥¨åŠ¡æ ¸é”€</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="verificationEvent">é€‰æ‹©æ´»åŠ¨</label>
                                <select id="verificationEvent" required>
                                    <option value="">è¯·é€‰æ‹©æ´»åŠ¨</option>
                                    <option value="1">å‘¨æ°ä¼¦æ¼”å”±ä¼š</option>
                                    <option value="2">äº”æœˆå¤©æ¼”å”±ä¼š</option>
                                </select>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-title">æ ¸é”€å·¥å…·</div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="verificationCode">è¾“å…¥æ ¸é”€ç </label>
                                    <input type="text" id="verificationCode" placeholder="è¯·è¾“å…¥12ä½æ ¸é”€ç " style="font-size: 24px; text-align: center; letter-spacing: 2px;">
                                </div>
                            </div>
                            <div class="btn-group" style="justify-content: center;">
                                <button type="button" class="btn btn-primary" onclick="verifyTicket()" style="padding: 15px 40px; font-size: 20px;">
                                    ğŸ“± æ‰«ç æ ¸é”€
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="manualVerify()" style="padding: 15px 40px; font-size: 20px;">
                                    ğŸ–‹ï¸ æ‰‹åŠ¨æ ¸é”€
                                </button>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-title">æ ¸é”€è®°å½•</div>
                            <div class="table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>æ ¸é”€ç </th>
                                            <th>çŠ¶æ€</th>
                                            <th>æ—¶é—´</th>
                                            <th>æ“ä½œäººå‘˜</th>
                                        </tr>
                                    </thead>
                                    <tbody id="verificationHistory">
                                        <tr>
                                            <td>123456789012</td>
                                            <td><span class="tag tag-success">å·²æ ¸é”€</span></td>
                                            <td>2024-01-15 14:30:25</td>
                                            <td>ç®¡ç†å‘˜</td>
                                        </tr>
                                        <tr>
                                            <td>234567890123</td>
                                            <td><span class="tag tag-danger">æ— æ•ˆ</span></td>
                                            <td>2024-01-15 14:25:18</td>
                                            <td>ç®¡ç†å‘˜</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- é”€å”®æŠ¥è¡¨é¡µé¢ -->
                <div id="reports" class="page hidden">
                    <div class="card">
                        <div class="card-title">ğŸ“ˆ é”€å”®æŠ¥è¡¨</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="reportEvent">é€‰æ‹©æ´»åŠ¨</label>
                                <select id="reportEvent" required>
                                    <option value="">è¯·é€‰æ‹©æ´»åŠ¨</option>
                                    <option value="1">å‘¨æ°ä¼¦æ¼”å”±ä¼š</option>
                                    <option value="2">äº”æœˆå¤©æ¼”å”±ä¼š</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="reportDateRange">æ—¥æœŸèŒƒå›´</label>
                                <select id="reportDateRange">
                                    <option value="today">ä»Šå¤©</option>
                                    <option value="yesterday">æ˜¨å¤©</option>
                                    <option value="week">æœ€è¿‘7å¤©</option>
                                    <option value="month">æœ€è¿‘30å¤©</option>
                                    <option value="custom">è‡ªå®šä¹‰</option>
                                </select>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-title">é”€å”®è¶‹åŠ¿</div>
                            <div class="chart-container">
                                <canvas id="salesTrendChart" width="400" height="200"></canvas>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-title">ç¥¨ç§é”€å”®å æ¯”</div>
                            <div class="chart-container">
                                <canvas id="ticketTypeChart" width="400" height="200"></canvas>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-title">é”€å”®æ•°æ®è¯¦æƒ…</div>
                            <div class="table-container">
                                <table class="data-table">
                                    <thead>
                                        <tr>
                                            <th>æ—¥æœŸ</th>
                                            <th>ç¥¨ç§</th>
                                            <th>å”®å‡ºç¥¨æ•°</th>
                                            <th>é”€å”®é¢</th>
                                        </tr>
                                    </thead>
                                    <tbody id="salesDetails">
                                        <tr>
                                            <td>2024-01-15</td>
                                            <td>VIPç¥¨</td>
                                            <td>120</td>
                                            <td>Â¥24,000</td>
                                        </tr>
                                        <tr>
                                            <td>2024-01-15</td>
                                            <td>æ™®é€šç¥¨</td>
                                            <td>280</td>
                                            <td>Â¥44,800</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å®¢æˆ·è´­ç¥¨é¡µé¢ -->
                <div id="customerPortal" class="page hidden">
                    <div class="card">
                        <div class="card-title">ğŸ‘¤ å®¢æˆ·è´­ç¥¨é¡µ</div>
                        <div style="text-align: center; margin: 30px 0;">
                            <h2>ğŸµ å‘¨æ°ä¼¦2024å·¡å›æ¼”å”±ä¼š</h2>
                            <p style="font-size: 18px; color: #666; margin: 10px 0;">2024å¹´6æœˆ15æ—¥ 19:30 | åŒ—äº¬é¸Ÿå·¢ä½“è‚²åœº</p>
                        </div>

                        <div class="card">
                            <div class="card-title">é€‰æ‹©ç¥¨ç§</div>
                            <div class="subscription-plans">
                                <div class="plan-card">
                                    <h3>å†…åœºVIP</h3>
                                    <div class="plan-price">Â¥1,280</div>
                                    <ul class="plan-features">
                                        <li>å†…åœºå‰åŒºåº§ä½</li>
                                        <li>ä¼˜å…ˆå…¥åœº</li>
                                        <li>é™é‡å‘¨è¾¹</li>
                                    </ul>
                                    <button class="btn btn-primary" onclick="selectTicketType('vip')">é€‰æ‹©æ­¤ç¥¨ç§</button>
                                </div>
                                <div class="plan-card popular">
                                    <h3>çœ‹å°ç¥¨</h3>
                                    <div class="plan-price">Â¥680</div>
                                    <ul class="plan-features">
                                        <li>çœ‹å°åŒºåº§ä½</li>
                                        <li>æ ‡å‡†è§†é‡</li>
                                        <li>å…è´¹åœè½¦</li>
                                    </ul>
                                    <button class="btn btn-primary" onclick="selectTicketType('stand')">é€‰æ‹©æ­¤ç¥¨ç§</button>
                                </div>
                                <div class="plan-card">
                                    <h3>ç‰¹æƒ ç¥¨</h3>
                                    <div class="plan-price">Â¥380</div>
                                    <ul class="plan-features">
                                        <li>çœ‹å°åŒºåº§ä½</li>
                                        <li>åŸºç¡€æœåŠ¡</li>
                                    </ul>
                                    <button class="btn btn-primary" onclick="selectTicketType('economy')">é€‰æ‹©æ­¤ç¥¨ç§</button>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-title">é€‰åº§</div>
                            <div class="seat-map-container">
                                <div class="seat-map">
                                    <div class="stage">èˆå°</div>
                                    <div class="seat-section">
                                        <div class="seat-row">
                                            <div class="seat available">VIP1</div>
                                            <div class="seat available">VIP2</div>
                                            <div class="seat sold">VIP3</div>
                                            <div class="seat available">VIP4</div>
                                            <div class="seat available">VIP5</div>
                                        </div>
                                        <div class="seat-row">
                                            <div class="seat available">A1</div>
                                            <div class="seat available">A2</div>
                                            <div class="seat available">A3</div>
                                            <div class="seat sold">A4</div>
                                            <div class="seat available">A5</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-title">å¡«å†™è´­ç¥¨ä¿¡æ¯</div>
                            <form id="customerForm">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="customerName">å§“å</label>
                                        <input type="text" id="customerName" placeholder="è¯·è¾“å…¥å§“å" required>
                                    </div>
                                    <div class="form-group">
                                        <label for="customerPhone">æ‰‹æœºå·</label>
                                        <input type="tel" id="customerPhone" placeholder="è¯·è¾“å…¥æ‰‹æœºå·" required>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="customerEmail">é‚®ç®±</label>
                                        <input type="email" id="customerEmail" placeholder="è¯·è¾“å…¥é‚®ç®±">
                                    </div>
                                    <div class="form-group">
                                        <label for="customerID">èº«ä»½è¯å·</label>
                                        <input type="text" id="customerID" placeholder="è¯·è¾“å…¥èº«ä»½è¯å·" required>
                                    </div>
                                </div>
                                <div class="btn-group" style="justify-content: center;">
                                    <button type="submit" class="btn btn-primary" style="padding: 15px 40px; font-size: 20px;">
                                        ğŸ’³ ç«‹å³æ”¯ä»˜
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- ç³»ç»Ÿè®¾ç½®é¡µé¢ -->
                <div id="settings" class="page hidden">
                    <div class="card">
                        <div class="card-title">âš™ï¸ ç³»ç»Ÿè®¾ç½®</div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="systemName">ç³»ç»Ÿåç§°</label>
                                <input type="text" id="systemName" value="ç¥¨åŠ¡ç³»ç»Ÿ" required>
                            </div>
                            <div class="form-group">
                                <label for="systemLogo">ç³»ç»ŸLogo</label>
                                <input type="file" id="systemLogo" accept="image/*">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="systemDomain">ç³»ç»ŸåŸŸå</label>
                                <input type="text" id="systemDomain" value="ticket.example.com" required>
                            </div>
                            <div class="form-group">
                                <label for="customerService">å®¢æœç”µè¯</label>
                                <input type="tel" id="customerService" value="400-123-4567" required>
                            </div>
                        </div>

                        <div class="btn-group">
                            <button type="button" class="btn btn-primary" onclick="saveSettings()">ä¿å­˜è®¾ç½®</button>
                            <button type="button" class="btn btn-secondary" onclick="resetSettings()">é‡ç½®</button>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- ç³»ç»Ÿæ¶ˆæ¯ -->
    <div id="toast" class="toast"></div>

    <!-- æ¨¡æ€æ¡† -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle">ç¡®è®¤æ“ä½œ</h3>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <div id="modalBody">
                <!-- æ¨¡æ€æ¡†å†…å®¹ -->
            </div>
            <div class="btn-group" style="justify-content: flex-end;">
                <button class="btn btn-secondary" onclick="closeModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" id="modalConfirmBtn">ç¡®è®¤</button>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let currentPage = 'dashboard';

        // æ•°æ®æŒä¹…åŒ–åŠŸèƒ½
        function initData() {
            // æ£€æŸ¥æ˜¯å¦å·²æœ‰æ•°æ®
            if (!localStorage.getItem('ticketSystemData')) {
                const defaultData = {
                    events: [
                        {
                            id: 1,
                            name: 'å‘¨æ°ä¼¦æ¼”å”±ä¼š',
                            date: '2024-06-15',
                            location: 'åŒ—äº¬é¸Ÿå·¢',
                            poster: '',
                            ticketType: 'seat',
                            inventory: {
                                type: 'seat',
                                sections: ['VIP', 'A', 'B'],
                                seats: [
                                    { id: 'VIP1', section: 'VIP', price: 1280, status: 'available', phasePrices: { earlyBird: 1000, regular: 1280 } },
                                    { id: 'VIP2', section: 'VIP', price: 1280, status: 'sold', phasePrices: { earlyBird: 1000, regular: 1280 } },
                                    { id: 'VIP3', section: 'VIP', price: 1280, status: 'available', phasePrices: { earlyBird: 1000, regular: 1280 } },
                                    { id: 'VIP4', section: 'VIP', price: 1280, status: 'locked', phasePrices: { earlyBird: 1000, regular: 1280 } },
                                    { id: 'VIP5', section: 'VIP', price: 1280, status: 'available', phasePrices: { earlyBird: 1000, regular: 1280 } },
                                    { id: 'A1', section: 'A', price: 680, status: 'available', phasePrices: { earlyBird: 550, regular: 680 } },
                                    { id: 'A2', section: 'A', price: 680, status: 'available', phasePrices: { earlyBird: 550, regular: 680 } },
                                    { id: 'A3', section: 'A', price: 680, status: 'sold', phasePrices: { earlyBird: 550, regular: 680 } },
                                    { id: 'A4', section: 'A', price: 680, status: 'available', phasePrices: { earlyBird: 550, regular: 680 } },
                                    { id: 'A5', section: 'A', price: 680, status: 'available', phasePrices: { earlyBird: 550, regular: 680 } },
                                    { id: 'B1', section: 'B', price: 380, status: 'available', phasePrices: { earlyBird: 300, regular: 380 } },
                                    { id: 'B2', section: 'B', price: 380, status: 'sold', phasePrices: { earlyBird: 300, regular: 380 } },
                                    { id: 'B3', section: 'B', price: 380, status: 'sold', phasePrices: { earlyBird: 300, regular: 380 } },
                                    { id: 'B4', section: 'B', price: 380, status: 'available', phasePrices: { earlyBird: 300, regular: 380 } },
                                    { id: 'B5', section: 'B', price: 380, status: 'locked', phasePrices: { earlyBird: 300, regular: 380 } }
                                ]
                            },
                            sales: {
                                phases: [
                                    {
                                        name: 'earlyBird',
                                        label: 'æ—©é¸Ÿç¥¨',
                                        startDate: '2024-01-01T00:00:00',
                                        endDate: '2024-03-01T23:59:59',
                                        price: 1000
                                    },
                                    {
                                        name: 'regular',
                                        label: 'æ™®é€šç¥¨',
                                        startDate: '2024-03-02T00:00:00',
                                        endDate: '2024-06-14T23:59:59',
                                        price: 1280
                                    }
                                ],
                                maxTicketsPerUser: 4,
                                maxTicketsPerPhone: 4,
                                antiBrushEnabled: true,
                                requestLimit: 10
                            },
                            status: 'é”€å”®ä¸­',
                            currentPhase: 'regular',
                            totalSales: 128000
                        },
                        {
                            id: 2,
                            name: 'äº”æœˆå¤©æ¼”å”±ä¼š',
                            date: '2024-07-20',
                            location: 'ä¸Šæµ·ä½“è‚²åœº',
                            poster: '',
                            ticketType: 'free',
                            inventory: {
                                type: 'free',
                                total: 10000,
                                available: 8500,
                                locked: 500,
                                sold: 1000,
                                price: 880,
                                phasePrices: { earlyBird: 700, regular: 880 }
                            },
                            sales: {
                                phases: [
                                    {
                                        name: 'earlyBird',
                                        label: 'æ—©é¸Ÿç¥¨',
                                        startDate: '2024-02-01T00:00:00',
                                        endDate: '2024-04-01T23:59:59',
                                        price: 700
                                    },
                                    {
                                        name: 'regular',
                                        label: 'æ™®é€šç¥¨',
                                        startDate: '2024-04-02T00:00:00',
                                        endDate: '2024-07-19T23:59:59',
                                        price: 880
                                    }
                                ],
                                maxTicketsPerUser: 4,
                                maxTicketsPerPhone: 4,
                                antiBrushEnabled: true,
                                requestLimit: 10
                            },
                            status: 'é”€å”®ä¸­',
                            currentPhase: 'regular',
                            totalSales: 89500
                        },
                        {
                            id: 3,
                            name: 'å­™ç‡•å§¿æ¼”å”±ä¼š',
                            date: '2024-08-10',
                            location: 'å¹¿å·ä½“è‚²é¦†',
                            poster: '',
                            ticketType: 'free',
                            inventory: {
                                type: 'free',
                                total: 8000,
                                available: 8000,
                                locked: 0,
                                sold: 0,
                                price: 550,
                                phasePrices: { earlyBird: 550, regular: 680 }
                            },
                            sales: {
                                phases: [
                                    {
                                        name: 'earlyBird',
                                        label: 'æ—©é¸Ÿç¥¨',
                                        startDate: '2024-03-01T00:00:00',
                                        endDate: '2024-05-01T23:59:59',
                                        price: 550
                                    },
                                    {
                                        name: 'regular',
                                        label: 'æ™®é€šç¥¨',
                                        startDate: '2024-05-02T00:00:00',
                                        endDate: '2024-08-09T23:59:59',
                                        price: 680
                                    }
                                ],
                                maxTicketsPerUser: 4,
                                maxTicketsPerPhone: 4,
                                antiBrushEnabled: true,
                                requestLimit: 10
                            },
                            status: 'å³å°†å¼€å”®',
                            totalSales: 0
                        }
                    ],
                    orders: [
                        { id: 1, eventId: 1, customerName: 'å¼ ä¸‰', customerPhone: '13800138000', customerID: '110101199001011234', tickets: [{ seatId: 'VIP2', price: 1280 }], totalAmount: 1280, status: 'å·²æ”¯ä»˜', verificationCode: '123456789012', verificationStatus: 'å·²æ ¸é”€', createdAt: '2024-01-15 10:30:00' },
                        { id: 2, eventId: 1, customerName: 'æå››', customerPhone: '13900139000', customerID: '110101199101011234', tickets: [{ seatId: 'A3', price: 680 }], totalAmount: 680, status: 'å·²æ”¯ä»˜', verificationCode: '234567890123', verificationStatus: 'æœªæ ¸é”€', createdAt: '2024-01-15 11:00:00' },
                        { id: 3, eventId: 2, customerName: 'ç‹äº”', customerPhone: '13700137000', customerID: '110101199201011234', tickets: [{ ticketId: 1, price: 880 }], totalAmount: 880, status: 'å·²æ”¯ä»˜', verificationCode: '345678901234', verificationStatus: 'å·²æ ¸é”€', createdAt: '2024-01-15 14:30:00' }
                    ],
                    settings: {
                        systemName: 'ç¥¨åŠ¡ç³»ç»Ÿ',
                        domain: 'ticket.example.com',
                        customerService: '400-123-4567'
                    }
                };
                localStorage.setItem('ticketSystemData', JSON.stringify(defaultData));
            }
        }

        // è·å–æ•°æ®
        function getData() {
            return JSON.parse(localStorage.getItem('ticketSystemData'));
        }

        // ä¿å­˜æ•°æ®
        function saveData(data) {
            localStorage.setItem('ticketSystemData', JSON.stringify(data));
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–æ•°æ®
            initData();
            // åˆå§‹åŒ–æ´»åŠ¨åˆ—è¡¨
            initEventList();
            
            // åˆå§‹åŒ–ç¥¨ç§ç±»å‹åˆ‡æ¢
            document.getElementById('ticketType').addEventListener('change', function() {
                toggleTicketSettings();
            });

            // åˆå§‹åŒ–äº‹ä»¶è¡¨å•æäº¤
            document.getElementById('eventForm').addEventListener('submit', function(e) {
                e.preventDefault();
                createEvent();
            });

            // åˆå§‹åŒ–å®¢æˆ·è¡¨å•æäº¤
            document.getElementById('customerForm').addEventListener('submit', function(e) {
                e.preventDefault();
                submitOrder();
            });

            // åˆå§‹åŒ–åº“å­˜æ»‘å—
            document.getElementById('totalInventorySlider').addEventListener('input', function() {
                updateInventoryValue(this.value);
            });

            // é»˜è®¤æ˜¾ç¤ºè‡ªç”±åº“å­˜è®¾ç½®
            toggleTicketSettings();
            
            // åˆå§‹åŒ–æ‹–æ‹½é€‰æ‹©åŠŸèƒ½
            initDragSelection();
            
            // åˆå§‹åŒ–å›¾è¡¨
            initCharts();
            
            // åˆå§‹åŒ–é”€å”®é˜¶æ®µæ£€æŸ¥å™¨
            initSalesPhaseChecker();
        });

        // æ˜¾ç¤ºé¡µé¢
        function showPage(pageId) {
            // éšè—æ‰€æœ‰é¡µé¢
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });

            // æ˜¾ç¤ºé€‰ä¸­é¡µé¢
            document.getElementById(pageId).classList.remove('hidden');
            currentPage = pageId;

            // æ›´æ–°é¡µé¢æ ‡é¢˜
            const pageTitles = {
                'dashboard': 'æ•°æ®ä»ªè¡¨ç›˜',
                'createEvent': 'åˆ›å»ºæ´»åŠ¨',
                'inventory': 'åº“å­˜ç®¡ç†',
                'sales': 'é”€å”®æ§åˆ¶',
                'verification': 'ç¥¨åŠ¡æ ¸é”€',
                'reports': 'é”€å”®æŠ¥è¡¨',
                'customerPortal': 'å®¢æˆ·è´­ç¥¨é¡µ',
                'settings': 'ç³»ç»Ÿè®¾ç½®'
            };
            document.getElementById('pageTitle').textContent = pageTitles[pageId];

            // æ›´æ–°å¯¼èˆªé“¾æ¥
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            // æ‰¾åˆ°å¯¹åº”é¡µé¢çš„å¯¼èˆªé“¾æ¥å¹¶æ·»åŠ activeç±»
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => {
                if (link.getAttribute('onclick') && link.getAttribute('onclick').includes(pageId)) {
                    link.classList.add('active');
                }
            });
            
            // å¦‚æœæ˜¯é”€å”®æ§åˆ¶é¡µé¢ï¼Œåˆå§‹åŒ–é¡µé¢å†…å®¹
            if (pageId === 'sales') {
                initSalesPage();
            }
        }

        // æ˜¾ç¤ºç³»ç»Ÿæ¶ˆæ¯
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type}`;
            toast.classList.add('show');

            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // æ˜¾ç¤ºæ¨¡æ€æ¡†
        function showModal(title, body, confirmCallback) {
            document.getElementById('modalTitle').textContent = title;
            document.getElementById('modalBody').innerHTML = body;
            document.getElementById('modal').classList.add('show');

            // è®¾ç½®ç¡®è®¤æŒ‰é’®å›è°ƒ
            document.getElementById('modalConfirmBtn').onclick = function() {
                if (confirmCallback) confirmCallback();
                closeModal();
            };
        }

        // å…³é—­æ¨¡æ€æ¡†
        function closeModal() {
            document.getElementById('modal').classList.remove('show');
        }

        // åˆå§‹åŒ–æ´»åŠ¨åˆ—è¡¨
        function initEventList() {
            const data = getData();
            const events = data.events;

            const eventList = document.getElementById('eventList');
            eventList.innerHTML = '';

            events.forEach((event) => {
                const row = document.createElement('tr');
                // æ ¹æ®çŠ¶æ€è®¾ç½®ä¸åŒçš„æ ‡ç­¾é¢œè‰²
                let tagClass = 'tag-success';
                if (event.status === 'å³å°†å¼€å”®') {
                    tagClass = 'tag-warning';
                } else if (event.status === 'å·²ç»“æŸ') {
                    tagClass = 'tag-danger';
                } else if (event.status === 'é”€å”®ä¸­') {
                    tagClass = 'tag-success';
                } else {
                    tagClass = 'tag-info';
                }
                row.innerHTML = `
                    <td>${event.name}</td>
                    <td>${event.date}</td>
                    <td>${event.location}</td>
                    <td><span class="tag ${tagClass}">${event.status}</span></td>
                    <td>Â¥${event.totalSales.toLocaleString()}</td>
                    <td>
                        <button class="btn btn-primary" style="padding: 5px 10px; font-size: 12px; margin-right: 5px;" onclick="editEvent(${event.id})">
                            ç¼–è¾‘
                        </button>
                        <button class="btn btn-secondary" style="padding: 5px 10px; font-size: 12px;" onclick="viewEvent(${event.id})">
                            æŸ¥çœ‹
                        </button>
                    </td>
                `;
                eventList.appendChild(row);
            });
        }

        // åˆ‡æ¢ç¥¨ç§è®¾ç½®
        function toggleTicketSettings() {
            const ticketType = document.getElementById('ticketType').value;
            const freeSettings = document.getElementById('freeTicketSettings');
            const seatSettings = document.getElementById('seatTicketSettings');

            if (ticketType === 'free') {
                freeSettings.classList.remove('hidden');
                seatSettings.classList.add('hidden');
            } else if (ticketType === 'seat') {
                freeSettings.classList.add('hidden');
                seatSettings.classList.remove('hidden');
            } else {
                freeSettings.classList.add('hidden');
                seatSettings.classList.add('hidden');
            }
        }

        // åˆ›å»ºæ´»åŠ¨
        function createEvent() {
            const eventName = document.getElementById('eventName').value;
            const eventDate = document.getElementById('eventDate').value;
            const eventLocation = document.getElementById('eventLocation').value;
            const ticketType = document.getElementById('ticketType').value;

            // éªŒè¯å¿…å¡«å­—æ®µ
            if (!eventName || !eventDate || !eventLocation || !ticketType) {
                showToast('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ', 'error');
                return;
            }

            // è·å–ç°æœ‰æ•°æ®
            const data = getData();
            
            // ç”Ÿæˆæ–°æ´»åŠ¨ID
            const newEventId = Math.max(...data.events.map(e => e.id), 0) + 1;
            
            // è®¾ç½®é”€å”®é˜¶æ®µ
            const earlyBirdStart = document.getElementById('earlyBirdStart').value;
            const earlyBirdEnd = document.getElementById('earlyBirdEnd').value;
            const earlyBirdPrice = parseFloat(document.getElementById('earlyBirdPrice').value);
            const regularStart = document.getElementById('regularStart').value;
            const regularEnd = document.getElementById('regularEnd').value;
            const regularPrice = parseFloat(document.getElementById('regularPrice').value);
            const maxPerUser = document.getElementById('maxPerUser').value;
            
            let inventoryData;
            if (ticketType === 'free') {
                const totalInventory = parseInt(document.getElementById('freeTotalInventory').value);
                inventoryData = {
                    type: 'free',
                    total: totalInventory,
                    available: totalInventory,
                    locked: 0,
                    sold: 0,
                    price: regularPrice, // é»˜è®¤ä½¿ç”¨æ™®é€šç¥¨ä»·
                    phasePrices: {
                        earlyBird: earlyBirdPrice,
                        regular: regularPrice
                    }
                };
            } else {
                // ä¸ºåº§ä½ç¥¨åˆå§‹åŒ–ç®€å•åº§ä½æ•°æ®
                const sectionName = document.getElementById('seatSection').value;
                const seats = [];
                
                // ç”Ÿæˆç¤ºä¾‹åº§ä½æ•°æ®ï¼ˆ5æ’5åˆ—ï¼‰
                for (let i = 1; i <= 5; i++) {
                    for (let j = 1; j <= 5; j++) {
                        seats.push({
                            id: `${sectionName}${i}${j}`,
                            section: sectionName,
                            price: regularPrice, // é»˜è®¤ä½¿ç”¨æ™®é€šç¥¨ä»·
                            phasePrices: {
                                earlyBird: earlyBirdPrice,
                                regular: regularPrice
                            },
                            status: 'available'
                        });
                    }
                }
                
                inventoryData = {
                    type: 'seat',
                    sections: [sectionName],
                    seats: seats
                };
            }

            // åˆ›å»ºæ–°æ´»åŠ¨å¯¹è±¡
            const newEvent = {
                id: newEventId,
                name: eventName,
                date: eventDate,
                location: eventLocation,
                poster: '',
                ticketType: ticketType,
                inventory: inventoryData,
                sales: {
                    phases: [
                        {
                            name: 'earlyBird',
                            label: 'æ—©é¸Ÿç¥¨',
                            startDate: earlyBirdStart,
                            endDate: earlyBirdEnd,
                            price: earlyBirdPrice
                        },
                        {
                            name: 'regular',
                            label: 'æ™®é€šç¥¨',
                            startDate: regularStart,
                            endDate: regularEnd,
                            price: regularPrice
                        }
                    ],
                    maxTicketsPerUser: parseInt(maxPerUser),
                    maxTicketsPerPhone: parseInt(maxPerUser),
                    antiBrushEnabled: true,
                    requestLimit: 10
                },
                status: 'å³å°†å¼€å”®',
                currentPhase: null,
                totalSales: 0
            };

            // å°†æ–°æ´»åŠ¨æ·»åŠ åˆ°æ•°æ®ä¸­
            data.events.push(newEvent);
            
            // ä¿å­˜æ•°æ®
            saveData(data);
            
            // æ›´æ–°æ´»åŠ¨åˆ—è¡¨
            initEventList();
            
            // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
            showToast('æ´»åŠ¨åˆ›å»ºæˆåŠŸï¼', 'success');
            
            // é‡ç½®è¡¨å•
            resetForm();
        }

        // é‡ç½®è¡¨å•
        function resetForm() {
            document.getElementById('eventForm').reset();
            toggleTicketSettings();
        }

        // æ£€æŸ¥é”€å”®é˜¶æ®µå¹¶è‡ªåŠ¨åˆ‡æ¢
        function checkSalesPhases() {
            const data = getData();
            const now = new Date();
            let updated = false;

            data.events.forEach(event => {
                let currentPhase = null;
                let eventStatus = 'å³å°†å¼€å”®';

                // æ£€æŸ¥å½“å‰å¤„äºå“ªä¸ªé”€å”®é˜¶æ®µ
                let foundActivePhase = false;
                let nextPhase = null;
                
                // å…ˆæ’åºé˜¶æ®µï¼Œç¡®ä¿æŒ‰æ—¶é—´é¡ºåºæ£€æŸ¥
                const sortedPhases = [...event.sales.phases].sort((a, b) => new Date(a.startDate) - new Date(b.startDate));
                
                for (const phase of sortedPhases) {
                    const phaseStart = new Date(phase.startDate);
                    const phaseEnd = new Date(phase.endDate);

                    if (now >= phaseStart && now <= phaseEnd) {
                        currentPhase = phase.name;
                        eventStatus = 'é”€å”®ä¸­';
                        foundActivePhase = true;
                        break;
                    } else if (now < phaseStart && !nextPhase) {
                        // æ‰¾åˆ°ç¬¬ä¸€ä¸ªæœªæ¥çš„é˜¶æ®µ
                        nextPhase = phase;
                        eventStatus = 'å³å°†å¼€å”®';
                    } else if (now > phaseEnd) {
                        // æ£€æŸ¥æ˜¯å¦æ˜¯æœ€åä¸€ä¸ªé˜¶æ®µ
                        const lastPhase = sortedPhases[sortedPhases.length - 1];
                        if (phase.name === lastPhase.name) {
                            eventStatus = 'å·²ç»“æŸ';
                        }
                    }
                }
                
                // å¦‚æœæ‰€æœ‰é˜¶æ®µéƒ½å·²ç»“æŸ
                if (sortedPhases.length > 0) {
                    const lastPhase = sortedPhases[sortedPhases.length - 1];
                    const lastPhaseEnd = new Date(lastPhase.endDate);
                    if (now > lastPhaseEnd) {
                        eventStatus = 'å·²ç»“æŸ';
                    }
                }

                // å¦‚æœé˜¶æ®µå‘ç”Ÿå˜åŒ–ï¼Œæ›´æ–°ä»·æ ¼
                if (event.currentPhase !== currentPhase) {
                    event.currentPhase = currentPhase;
                    
                    // æ›´æ–°ä»·æ ¼
                    if (event.ticketType === 'free') {
                        if (currentPhase && event.inventory.phasePrices) {
                            event.inventory.price = event.inventory.phasePrices[currentPhase];
                        }
                    } else if (event.inventory.seats) {
                        // æ›´æ–°æ‰€æœ‰åº§ä½çš„ä»·æ ¼
                        event.inventory.seats.forEach(seat => {
                            if (currentPhase && seat.phasePrices) {
                                seat.price = seat.phasePrices[currentPhase];
                            }
                        });
                    }
                    
                    updated = true;
                }

                // æ›´æ–°æ´»åŠ¨çŠ¶æ€
                if (event.status !== eventStatus) {
                    event.status = eventStatus;
                    updated = true;
                }
            });

            // å¦‚æœæœ‰æ›´æ–°ï¼Œä¿å­˜æ•°æ®å¹¶åˆ·æ–°é¡µé¢
            if (updated) {
                saveData(data);
                initEventList();
                showToast('é”€å”®é˜¶æ®µå·²æ›´æ–°', 'info');
            }
        }

        // åˆå§‹åŒ–é”€å”®é˜¶æ®µæ£€æŸ¥å®šæ—¶å™¨
        function initSalesPhaseChecker() {
            // ç«‹å³æ£€æŸ¥ä¸€æ¬¡
            checkSalesPhases();
            // æ¯30ç§’æ£€æŸ¥ä¸€æ¬¡
            setInterval(checkSalesPhases, 30000);
        }

        // æ‰¹é‡å¯¼å…¥æ´»åŠ¨
        function batchImportEvents() {
            showModal('æ‰¹é‡å¯¼å…¥æ´»åŠ¨', `
                <div class="form-group">
                    <label for="batchFile">é€‰æ‹©CSVæ–‡ä»¶</label>
                    <input type="file" id="batchFile" accept=".csv" required>
                </div>
                <p style="color: #666; font-size: 14px; margin-top: 15px;">
                    è¯·å‡†å¤‡CSVæ ¼å¼çš„æ´»åŠ¨æ•°æ®ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µï¼šæ´»åŠ¨åç§°,æ´»åŠ¨æ—¶é—´,åœ°ç‚¹,ç¥¨ç§ç±»å‹,ä»·æ ¼,åº“å­˜
                </p>
            `, function() {
                showToast('æ‰¹é‡å¯¼å…¥æˆåŠŸï¼', 'success');
            });
        }

        // æ›´æ–°åº“å­˜å€¼
        function updateInventoryValue(value) {
            document.querySelector('.inventory-value.total').textContent = value;
        }

        // æ›´æ–°å½“å‰é”€å”®é˜¶æ®µä¿¡æ¯æ˜¾ç¤º
        function updateCurrentSalesPhaseInfo() {
            const eventId = document.getElementById('salesEvent').value;
            const infoDiv = document.getElementById('currentSalesPhaseInfo');
            
            if (!eventId) {
                infoDiv.innerHTML = '<p style="color: #666; text-align: center;">è¯·å…ˆé€‰æ‹©ä¸€ä¸ªæ´»åŠ¨æŸ¥çœ‹å½“å‰é”€å”®é˜¶æ®µä¿¡æ¯</p>';
                return;
            }
            
            const data = getData();
            const event = data.events.find(e => e.id == eventId);
            
            if (!event) {
                infoDiv.innerHTML = '<p style="color: #dc3545; text-align: center;">æ´»åŠ¨ä¸å­˜åœ¨</p>';
                return;
            }
            
            // è·å–å½“å‰é˜¶æ®µä¿¡æ¯
            let currentPhaseInfo = '';
            if (event.currentPhase) {
                const currentPhase = event.sales.phases.find(p => p.name === event.currentPhase);
                if (currentPhase) {
                    currentPhaseInfo = `
                        <div class="form-row">
                            <div class="form-group">
                                <label style="font-weight: bold; color: #667eea;">å½“å‰é”€å”®é˜¶æ®µ:</label>
                                <p style="margin: 0; color: #333;">${currentPhase.label} (${event.currentPhase})</p>
                            </div>
                            <div class="form-group">
                                <label style="font-weight: bold; color: #667eea;">å½“å‰ä»·æ ¼:</label>
                                <p style="margin: 0; color: #333; font-size: 20px; font-weight: bold;">Â¥${event.ticketType === 'free' ? event.inventory.price : event.inventory.seats[0].price}</p>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label style="font-weight: bold; color: #667eea;">é˜¶æ®µæ—¶é—´èŒƒå›´:</label>
                                <p style="margin: 0; color: #333;">${new Date(currentPhase.startDate).toLocaleString()} - ${new Date(currentPhase.endDate).toLocaleString()}</p>
                            </div>
                            <div class="form-group">
                                <label style="font-weight: bold; color: #667eea;">é”€å”®çŠ¶æ€:</label>
                                <p style="margin: 0;"><span class="tag ${event.status === 'é”€å”®ä¸­' ? 'tag-success' : event.status === 'å³å°†å¼€å”®' ? 'tag-warning' : 'tag-danger'}">${event.status}</span></p>
                            </div>
                        </div>
                    `;
                }
            } else {
                currentPhaseInfo = `
                    <div class="form-row">
                        <div class="form-group">
                            <label style="font-weight: bold; color: #667eea;">å½“å‰é”€å”®é˜¶æ®µ:</label>
                            <p style="margin: 0; color: #666;">æ— æ´»åŠ¨é”€å”®é˜¶æ®µ</p>
                        </div>
                        <div class="form-group">
                            <label style="font-weight: bold; color: #667eea;">é”€å”®çŠ¶æ€:</label>
                            <p style="margin: 0;"><span class="tag ${event.status === 'é”€å”®ä¸­' ? 'tag-success' : event.status === 'å³å°†å¼€å”®' ? 'tag-warning' : 'tag-danger'}">${event.status}</span></p>
                        </div>
                    </div>
                `;
            }
            
            // æ˜¾ç¤ºæ‰€æœ‰é˜¶æ®µä¿¡æ¯
            const allPhasesInfo = event.sales.phases.map((phase, index) => {
                const phaseStart = new Date(phase.startDate);
                const phaseEnd = new Date(phase.endDate);
                const now = new Date();
                let phaseStatus = '';
                
                if (now < phaseStart) {
                    phaseStatus = '<span class="tag tag-warning">æœªå¼€å§‹</span>';
                } else if (now >= phaseStart && now <= phaseEnd) {
                    phaseStatus = '<span class="tag tag-success">è¿›è¡Œä¸­</span>';
                } else {
                    phaseStatus = '<span class="tag tag-danger">å·²ç»“æŸ</span>';
                }
                
                return `
                    <div class="phase" style="margin-bottom: 10px;">
                        <div class="phase-header" style="display: flex; justify-content: space-between; align-items: center;">
                            <h4>${phase.label} (${phase.name})</h4>
                            ${phaseStatus}
                        </div>
                        <div style="display: flex; gap: 20px; color: #666; font-size: 14px;">
                            <span>æ—¶é—´: ${phaseStart.toLocaleString()} - ${phaseEnd.toLocaleString()}</span>
                            <span>ä»·æ ¼: Â¥${phase.price}</span>
                        </div>
                    </div>
                `;
            }).join('');
            
            // ç»„åˆæ‰€æœ‰ä¿¡æ¯
            infoDiv.innerHTML = `
                ${currentPhaseInfo}
                <div style="margin-top: 20px;">
                    <h4 style="margin-bottom: 10px; color: #667eea;">æ‰€æœ‰é”€å”®é˜¶æ®µ:</h4>
                    <div class="sales-phases">
                        ${allPhasesInfo}
                    </div>
                </div>
            `;
        }
        
        // åˆå§‹åŒ–é”€å”®æ§åˆ¶é¡µé¢
        function initSalesPage() {
            const salesEventSelect = document.getElementById('salesEvent');
            const data = getData();
            const events = data.events;
            
            // æ¸…ç©ºå¹¶é‡æ–°å¡«å……æ´»åŠ¨é€‰æ‹©ä¸‹æ‹‰æ¡†
            salesEventSelect.innerHTML = '<option value="">è¯·é€‰æ‹©æ´»åŠ¨</option>';
            events.forEach(event => {
                const option = document.createElement('option');
                option.value = event.id;
                option.textContent = event.name;
                salesEventSelect.appendChild(option);
            });
            
            // æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
            salesEventSelect.addEventListener('change', updateCurrentSalesPhaseInfo);
        }
        
        // ä¿å­˜é”€å”®è®¾ç½®
        function saveSalesSettings() {
            const eventId = document.getElementById('salesEvent').value;
            if (!eventId) {
                showToast('è¯·é€‰æ‹©æ´»åŠ¨', 'error');
                return;
            }

            // è·å–é”€å”®é˜¶æ®µè®¾ç½®
            const earlyBirdStart = document.getElementById('earlyBirdStart').value;
            const earlyBirdEnd = document.getElementById('earlyBirdEnd').value;
            const earlyBirdPrice = parseFloat(document.getElementById('earlyBirdPrice').value);
            const regularStart = document.getElementById('regularStart').value;
            const regularEnd = document.getElementById('regularEnd').value;
            const regularPrice = parseFloat(document.getElementById('regularPrice').value);
            const maxTicketsPerUser = parseInt(document.getElementById('maxTicketsPerUser').value);
            const maxTicketsPerPhone = parseInt(document.getElementById('maxTicketsPerPhone').value);
            const antiBrushEnabled = document.getElementById('antiBrushEnabled').checked;
            const requestLimit = parseInt(document.getElementById('requestLimit').value);

            // æ›´æ–°æ´»åŠ¨æ•°æ®
            const data = getData();
            const eventIndex = data.events.findIndex(e => e.id == eventId);
            
            if (eventIndex !== -1) {
                // æ›´æ–°é”€å”®é˜¶æ®µ
                data.events[eventIndex].sales.phases = [
                    {
                        name: 'earlyBird',
                        label: 'æ—©é¸Ÿç¥¨',
                        startDate: earlyBirdStart,
                        endDate: earlyBirdEnd,
                        price: earlyBirdPrice
                    },
                    {
                        name: 'regular',
                        label: 'æ™®é€šç¥¨',
                        startDate: regularStart,
                        endDate: regularEnd,
                        price: regularPrice
                    }
                ];

                // æ›´æ–°é”€å”®è®¾ç½®
                data.events[eventIndex].sales.maxTicketsPerUser = maxTicketsPerUser;
                data.events[eventIndex].sales.maxTicketsPerPhone = maxTicketsPerPhone;
                data.events[eventIndex].sales.antiBrushEnabled = antiBrushEnabled;
                data.events[eventIndex].sales.requestLimit = requestLimit;

                // æ›´æ–°ä»·æ ¼ä¿¡æ¯
                if (data.events[eventIndex].ticketType === 'free') {
                    data.events[eventIndex].inventory.phasePrices = {
                        earlyBird: earlyBirdPrice,
                        regular: regularPrice
                    };
                } else {
                    data.events[eventIndex].inventory.seats.forEach(seat => {
                        seat.phasePrices = {
                            earlyBird: earlyBirdPrice,
                            regular: regularPrice
                        };
                    });
                }

                // ä¿å­˜æ•°æ®å¹¶é‡æ–°æ£€æŸ¥é”€å”®é˜¶æ®µ
                saveData(data);
                checkSalesPhases();
                showToast('é”€å”®è®¾ç½®ä¿å­˜æˆåŠŸï¼', 'success');
            } else {
                showToast('æ´»åŠ¨ä¸å­˜åœ¨', 'error');
            }
        }

        // é‡ç½®é”€å”®è®¾ç½®
        function resetSalesSettings() {
            document.getElementById('earlyBirdStart').value = '';
            document.getElementById('earlyBirdEnd').value = '';
            document.getElementById('earlyBirdPrice').value = '180';
            document.getElementById('regularPrice').value = '280';
            document.getElementById('maxTicketsPerUser').value = '4';
            document.getElementById('maxTicketsPerPhone').value = '4';
            document.getElementById('requestLimit').value = '10';
        }

        // éªŒè¯ç¥¨åŠ¡
        function verifyTicket() {
            showToast('æ ¸é”€æˆåŠŸï¼', 'success');
            document.getElementById('verificationCode').value = '';
        }

        // æ‰‹åŠ¨æ ¸é”€
        function manualVerify() {
            const code = document.getElementById('verificationCode').value;
            if (!code) {
                showToast('è¯·è¾“å…¥æ ¸é”€ç ', 'error');
                return;
            }
            verifyTicket();
        }

        // é€‰æ‹©ç¥¨ç§
        function selectTicketType(type) {
            showToast(`å·²é€‰æ‹©${type === 'vip' ? 'å†…åœºVIP' : type === 'stand' ? 'çœ‹å°ç¥¨' : 'ç‰¹æƒ ç¥¨'}ï¼`, 'success');
        }

        // æäº¤è®¢å•
        function submitOrder() {
            const name = document.getElementById('customerName').value;
            const phone = document.getElementById('customerPhone').value;
            const id = document.getElementById('customerID').value;

            if (!name || !phone || !id) {
                showToast('è¯·å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ', 'error');
                return;
            }

            showModal('ç¡®è®¤è®¢å•', `
                <h4>è®¢å•ä¿¡æ¯</h4>
                <p><strong>å§“åï¼š</strong>${name}</p>
                <p><strong>æ‰‹æœºå·ï¼š</strong>${phone}</p>
                <p><strong>èº«ä»½è¯å·ï¼š</strong>${id}</p>
                <p><strong>æ€»é‡‘é¢ï¼š</strong>Â¥680</p>
                <p style="color: #666; margin-top: 15px;">æ”¯ä»˜åå°†ç”Ÿæˆç”µå­ç¥¨ï¼Œå¯åœ¨ä¸ªäººä¸­å¿ƒæŸ¥çœ‹ã€‚</p>
            `, function() {
                showToast('è®¢å•æäº¤æˆåŠŸï¼', 'success');
                document.getElementById('customerForm').reset();
            });
        }

        // ä¿å­˜ç³»ç»Ÿè®¾ç½®
        function saveSettings() {
            showToast('ç³»ç»Ÿè®¾ç½®ä¿å­˜æˆåŠŸï¼', 'success');
        }

        // é‡ç½®ç³»ç»Ÿè®¾ç½®
        function resetSettings() {
            document.getElementById('systemName').value = 'ç¥¨åŠ¡ç³»ç»Ÿ';
            document.getElementById('systemDomain').value = 'ticket.example.com';
            document.getElementById('customerService').value = '400-123-4567';
        }

        // åˆå§‹åŒ–å›¾è¡¨æ•°æ®
        function initCharts() {
            drawSalesTrendChart();
            drawTicketTypeChart();
        }
        
        // ç»˜åˆ¶é”€å”®è¶‹åŠ¿å›¾
        function drawSalesTrendChart() {
            const canvas = document.getElementById('salesChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            if (!ctx) return;
            
            // è®¾ç½®ç”»å¸ƒå¤§å°
            canvas.width = 800;
            canvas.height = 400;
            
            // è·å–æ•°æ®
            const data = getData();
            const events = data.events;
            
            // æ¨¡æ‹Ÿè¿‡å»7å¤©çš„é”€å”®æ•°æ®
            const days = 7;
            const dates = [];
            const sales = [];
            
            for (let i = days - 1; i >= 0; i--) {
                const date = new Date();
                date.setDate(date.getDate() - i);
                dates.push(date.toLocaleDateString('zh-CN', { month: 'short', day: 'numeric' }));
                
                // ä¸ºæ¯ä¸€å¤©ç”Ÿæˆéšæœºé”€å”®æ•°æ®
                const dailySales = Math.floor(Math.random() * 5000) + 1000;
                sales.push(dailySales);
            }
            
            // è®¾ç½®å›¾è¡¨åŒºåŸŸ
            const padding = 50;
            const chartWidth = canvas.width - padding * 2;
            const chartHeight = canvas.height - padding * 2;
            
            // æ¸…ç©ºç”»å¸ƒ
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶ç½‘æ ¼çº¿
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 1;
            
            // ç»˜åˆ¶å‚ç›´ç½‘æ ¼çº¿
            for (let i = 1; i < days; i++) {
                const x = padding + (i * chartWidth / (days - 1));
                ctx.beginPath();
                ctx.moveTo(x, padding);
                ctx.lineTo(x, canvas.height - padding);
                ctx.stroke();
            }
            
            // ç»˜åˆ¶æ°´å¹³ç½‘æ ¼çº¿
            const gridLines = 5;
            for (let i = 0; i <= gridLines; i++) {
                const y = padding + (i * chartHeight / gridLines);
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();
            }
            
            // è®¡ç®—æœ€å¤§å€¼
            const maxSales = Math.max(...sales) * 1.1;
            
            // ç»˜åˆ¶æŠ˜çº¿
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            sales.forEach((sale, index) => {
                const x = padding + (index * chartWidth / (days - 1));
                const y = padding + chartHeight - (sale / maxSales * chartHeight);
                
                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
                
                // ç»˜åˆ¶æ•°æ®ç‚¹
                ctx.fillStyle = '#667eea';
                ctx.beginPath();
                ctx.arc(x, y, 5, 0, Math.PI * 2);
                ctx.fill();
            });
            
            ctx.stroke();
            
            // ç»˜åˆ¶Xè½´æ ‡ç­¾
            ctx.fillStyle = '#333';
            ctx.font = '12px å¾®è½¯é›…é»‘';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'top';
            
            dates.forEach((date, index) => {
                const x = padding + (index * chartWidth / (days - 1));
                ctx.fillText(date, x, canvas.height - padding + 10);
            });
            
            // ç»˜åˆ¶Yè½´æ ‡ç­¾
            ctx.textAlign = 'right';
            ctx.textBaseline = 'middle';
            
            for (let i = 0; i <= gridLines; i++) {
                const y = padding + (i * chartHeight / gridLines);
                const value = Math.round((maxSales / gridLines) * (gridLines - i));
                ctx.fillText(`Â¥${value.toLocaleString()}`, padding - 10, y);
            }
            
            // ç»˜åˆ¶æ ‡é¢˜
            ctx.textAlign = 'center';
            ctx.textBaseline = 'top';
            ctx.font = 'bold 16px å¾®è½¯é›…é»‘';
            ctx.fillStyle = '#667eea';
            ctx.fillText('è¿‘7å¤©é”€å”®è¶‹åŠ¿', canvas.width / 2, 10);
        }
        
        // ç»˜åˆ¶ç¥¨ç§å æ¯”å›¾
        function drawTicketTypeChart() {
            const canvas = document.getElementById('ticketTypeChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            if (!ctx) return;
            
            // è®¾ç½®ç”»å¸ƒå¤§å°
            canvas.width = 400;
            canvas.height = 300;
            
            // è·å–æ•°æ®
            const data = getData();
            const events = data.events;
            
            // è®¡ç®—ä¸åŒç¥¨ç§çš„é”€å”®æ•°æ®
            const ticketTypeData = {
                'VIP': 0,
                'AåŒº': 0,
                'BåŒº': 0,
                'CåŒº': 0
            };
            
            // æ¨¡æ‹Ÿç¥¨ç§é”€å”®æ•°æ®
            ticketTypeData['VIP'] = Math.floor(Math.random() * 1000) + 500;
            ticketTypeData['AåŒº'] = Math.floor(Math.random() * 2000) + 1000;
            ticketTypeData['BåŒº'] = Math.floor(Math.random() * 3000) + 1500;
            ticketTypeData['CåŒº'] = Math.floor(Math.random() * 2000) + 800;
            
            const total = Object.values(ticketTypeData).reduce((sum, value) => sum + value, 0);
            
            // ç»˜åˆ¶é¥¼å›¾
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = Math.min(centerX, centerY) - 50;
            
            const colors = ['#667eea', '#764ba2', '#f093fb', '#4facfe'];
            let startAngle = 0;
            
            Object.entries(ticketTypeData).forEach(([type, value], index) => {
                const sliceAngle = (value / total) * 2 * Math.PI;
                const color = colors[index % colors.length];
                
                // ç»˜åˆ¶æ‰‡å½¢
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, startAngle, startAngle + sliceAngle);
                ctx.closePath();
                ctx.fillStyle = color;
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // ç»˜åˆ¶æ ‡ç­¾
                const labelAngle = startAngle + sliceAngle / 2;
                const labelX = centerX + Math.cos(labelAngle) * (radius + 30);
                const labelY = centerY + Math.sin(labelAngle) * (radius + 30);
                
                ctx.fillStyle = '#333';
                ctx.font = '14px å¾®è½¯é›…é»‘';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(`${type} (${Math.round((value / total) * 100)}%)`, labelX, labelY);
                
                startAngle += sliceAngle;
            });
            
            // ç»˜åˆ¶æ ‡é¢˜
            ctx.textAlign = 'center';
            ctx.textBaseline = 'top';
            ctx.font = 'bold 16px å¾®è½¯é›…é»‘';
            ctx.fillStyle = '#667eea';
            ctx.fillText('ç¥¨ç§é”€å”®å æ¯”', canvas.width / 2, 10);
        }

        // ç‚¹å‡»åº§ä½
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('seat')) {
                toggleSeat(e.target);
            }
        });

        // åˆ‡æ¢åº§ä½çŠ¶æ€
        function toggleSeat(seatElement) {
            if (seatElement.classList.contains('available')) {
                seatElement.classList.toggle('selected');
            }
        }

        // é”®ç›˜äº‹ä»¶å¤„ç†
        document.addEventListener('keydown', function(e) {
            // æŒ‰Enteré”®æäº¤è¡¨å•
            if (e.key === 'Enter' && currentPage === 'createEvent') {
                createEvent();
            }
            // æŒ‰Escé”®å…³é—­æ¨¡æ€æ¡†
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // é¢„è§ˆåº§ä½å›¾
        function previewSeatMap(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                const fileType = input.files[0].type;
                
                // æ ¹æ®æ–‡ä»¶ç±»å‹é€‰æ‹©è¯»å–æ–¹å¼
                if (fileType === 'image/svg+xml') {
                    reader.readAsText(input.files[0]);
                } else {
                    reader.readAsDataURL(input.files[0]);
                }
                
                reader.onload = function(e) {
                    const seatMap = document.getElementById('seatMap');
                    const stage = seatMap.querySelector('.stage');
                    
                    // æ¸…ç©ºç°æœ‰åº§ä½å›¾å†…å®¹ï¼Œä¿ç•™èˆå°
                    seatMap.innerHTML = '';
                    seatMap.appendChild(stage);
                    
                    // åˆ›å»ºé¢„è§ˆå…ƒç´ 
                    const preview = document.createElement('div');
                    preview.style.position = 'relative';
                    preview.style.width = '100%';
                    preview.style.height = '300px';
                    preview.style.overflow = 'auto';
                    
                    if (fileType === 'image/svg+xml') {
                        // SVGç›´æ¥åµŒå…¥å¹¶å¤„ç†
                        preview.innerHTML = e.target.result;
                        
                        // ä¸ºSVGä¸­çš„åº§ä½å…ƒç´ æ·»åŠ äº‹ä»¶ç›‘å¬å™¨
                        const svgSeats = preview.querySelectorAll('path, rect, circle');
                        svgSeats.forEach(seat => {
                            seat.style.cursor = 'pointer';
                            seat.addEventListener('click', function() {
                                toggleSeatSelection(this);
                            });
                        });
                    } else {
                        // å›¾ç‰‡åˆ›å»ºimgå…ƒç´ 
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        img.style.maxWidth = '100%';
                        img.style.maxHeight = '300px';
                        img.style.position = 'relative';
                        preview.appendChild(img);
                        
                        // ä¸ºå›¾ç‰‡æ·»åŠ ç‚¹å‡»äº‹ä»¶ï¼Œå…è®¸æ‰‹åŠ¨æ ‡è®°åº§ä½
                        img.addEventListener('click', function(e) {
                            const rect = img.getBoundingClientRect();
                            const x = e.clientX - rect.left;
                            const y = e.clientY - rect.top;
                            addSeatToImage(preview, x, y);
                        });
                    }
                    
                    seatMap.appendChild(preview);
                    showToast('åº§ä½å›¾é¢„è§ˆæˆåŠŸï¼', 'success');
                }
            }
        }
        
        // åˆ‡æ¢åº§ä½é€‰æ‹©çŠ¶æ€
        function toggleSeatSelection(seatElement) {
            seatElement.classList.toggle('selected-seat');
            if (seatElement.classList.contains('selected-seat')) {
                seatElement.style.fill = '#667eea';
            } else {
                seatElement.style.fill = '#4CAF50';
            }
        }
        
        // åœ¨å›¾ç‰‡ä¸Šæ·»åŠ åº§ä½æ ‡è®°
        function addSeatToImage(container, x, y) {
            const seat = document.createElement('div');
            seat.className = 'seat-marker available';
            seat.style.position = 'absolute';
            seat.style.left = (x - 10) + 'px';
            seat.style.top = (y - 10) + 'px';
            seat.style.width = '20px';
            seat.style.height = '20px';
            seat.style.borderRadius = '50%';
            seat.style.backgroundColor = '#4CAF50';
            seat.style.cursor = 'pointer';
            seat.style.zIndex = '10';
            
            seat.addEventListener('click', function(e) {
                e.stopPropagation();
                toggleSeatMarker(seat);
            });
            
            container.appendChild(seat);
        }
        
        // åˆ‡æ¢åº§ä½æ ‡è®°çŠ¶æ€
        function toggleSeatMarker(seatMarker) {
            seatMarker.classList.toggle('selected');
            if (seatMarker.classList.contains('selected')) {
                seatMarker.style.backgroundColor = '#667eea';
            } else {
                seatMarker.style.backgroundColor = '#4CAF50';
            }
        }
        
        // æ‹–æ‹½é€‰æ‹©åŒºåŸŸåŠŸèƒ½
        let isSelecting = false;
        let startX, startY;
        let selectionRect;
        
        // åˆå§‹åŒ–æ‹–æ‹½é€‰æ‹©åŠŸèƒ½
        function initDragSelection() {
            const seatMap = document.getElementById('seatMap');
            
            seatMap.addEventListener('mousedown', function(e) {
                if (e.target.className.includes('seat-map')) {
                    startSelection(e);
                }
            });
            
            document.addEventListener('mousemove', function(e) {
                if (isSelecting) {
                    updateSelection(e);
                }
            });
            
            document.addEventListener('mouseup', function() {
                if (isSelecting) {
                    endSelection();
                }
            });
        }
        
        // å¼€å§‹é€‰æ‹©
        function startSelection(e) {
            isSelecting = true;
            startX = e.clientX;
            startY = e.clientY;
            
            // åˆ›å»ºé€‰æ‹©çŸ©å½¢
            selectionRect = document.createElement('div');
            selectionRect.className = 'selection-rect';
            selectionRect.style.position = 'absolute';
            selectionRect.style.border = '2px solid #667eea';
            selectionRect.style.backgroundColor = 'rgba(102, 126, 234, 0.3)';
            selectionRect.style.zIndex = '1000';
            selectionRect.style.left = startX + 'px';
            selectionRect.style.top = startY + 'px';
            selectionRect.style.width = '0px';
            selectionRect.style.height = '0px';
            
            document.body.appendChild(selectionRect);
        }
        
        // æ›´æ–°é€‰æ‹©åŒºåŸŸ
        function updateSelection(e) {
            if (!isSelecting) return;
            
            const currentX = e.clientX;
            const currentY = e.clientY;
            
            const left = Math.min(startX, currentX);
            const top = Math.min(startY, currentY);
            const width = Math.abs(currentX - startX);
            const height = Math.abs(currentY - startY);
            
            selectionRect.style.left = left + 'px';
            selectionRect.style.top = top + 'px';
            selectionRect.style.width = width + 'px';
            selectionRect.style.height = height + 'px';
        }
        
        // ç»“æŸé€‰æ‹©
        function endSelection() {
            isSelecting = false;
            
            if (selectionRect) {
                const rect = selectionRect.getBoundingClientRect();
                selectSeatsInRect(rect);
                
                // ç§»é™¤é€‰æ‹©çŸ©å½¢
                document.body.removeChild(selectionRect);
                selectionRect = null;
                
                // å¦‚æœæœ‰é€‰ä¸­çš„åº§ä½ï¼Œæ˜¾ç¤ºåˆ†åŒºå®šä»·å¯¹è¯æ¡†
                if (document.querySelector('.selected-seat, .seat-marker.selected')) {
                    showZonePricingModal();
                }
            }
        }
        
        // é€‰æ‹©çŸ©å½¢å†…çš„æ‰€æœ‰åº§ä½
        function selectSeatsInRect(rect) {
            // é€‰æ‹©SVGåº§ä½
            const svgSeats = document.querySelectorAll('.selected-seat, path, rect, circle');
            svgSeats.forEach(seat => {
                const seatRect = seat.getBoundingClientRect();
                if (isOverlapping(seatRect, rect)) {
                    seat.classList.add('selected-seat');
                    if (seat.tagName !== 'DIV') {
                        seat.style.fill = '#667eea';
                    }
                }
            });
            
            // é€‰æ‹©å›¾ç‰‡åº§ä½æ ‡è®°
            const seatMarkers = document.querySelectorAll('.seat-marker');
            seatMarkers.forEach(marker => {
                const markerRect = marker.getBoundingClientRect();
                if (isOverlapping(markerRect, rect)) {
                    marker.classList.add('selected');
                    marker.style.backgroundColor = '#667eea';
                }
            });
        }
        
        // æ£€æŸ¥ä¸¤ä¸ªçŸ©å½¢æ˜¯å¦é‡å 
        function isOverlapping(rect1, rect2) {
            return (
                rect1.left < rect2.right &&
                rect1.right > rect2.left &&
                rect1.top < rect2.bottom &&
                rect1.bottom > rect2.top
            );
        }
        
        // æ˜¾ç¤ºåˆ†åŒºå®šä»·å¯¹è¯æ¡†
        function showZonePricingModal() {
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <h2 class="modal-title">è®¾ç½®åŒºåŸŸä»·æ ¼</h2>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                    </div>
                    <div class="form-group">
                        <label for="zoneName">åŒºåŸŸåç§°</label>
                        <input type="text" id="zoneName" placeholder="ä¾‹å¦‚ï¼šAåŒºã€VIPåŒº" class="form-control">
                    </div>
                    <div class="form-group">
                        <label for="zonePrice">åŒºåŸŸä»·æ ¼ (å…ƒ)</label>
                        <input type="number" id="zonePrice" placeholder="è¾“å…¥ä»·æ ¼" min="0" step="0.01" class="form-control">
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="applyZonePricing()">åº”ç”¨ä»·æ ¼</button>
                        <button class="btn btn-secondary" onclick="cancelZonePricing()">å–æ¶ˆ</button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        // åº”ç”¨åŒºåŸŸä»·æ ¼
        function applyZonePricing() {
            const zoneName = document.getElementById('zoneName').value;
            const zonePrice = parseFloat(document.getElementById('zonePrice').value);
            
            if (!zoneName || isNaN(zonePrice)) {
                showToast('è¯·å¡«å†™åŒºåŸŸåç§°å’Œä»·æ ¼', 'error');
                return;
            }
            
            // åº”ç”¨ä»·æ ¼åˆ°é€‰ä¸­çš„SVGåº§ä½
            const svgSeats = document.querySelectorAll('.selected-seat');
            svgSeats.forEach(seat => {
                seat.dataset.zone = zoneName;
                seat.dataset.price = zonePrice;
                seat.classList.remove('selected-seat');
                seat.style.fill = '#4CAF50';
            });
            
            // åº”ç”¨ä»·æ ¼åˆ°é€‰ä¸­çš„å›¾ç‰‡åº§ä½æ ‡è®°
            const seatMarkers = document.querySelectorAll('.seat-marker.selected');
            seatMarkers.forEach(marker => {
                marker.dataset.zone = zoneName;
                marker.dataset.price = zonePrice;
                marker.classList.remove('selected');
                marker.style.backgroundColor = '#4CAF50';
            });
            
            showToast(`å·²ä¸º${zoneName}åŒºåŸŸè®¾ç½®ä»·æ ¼ï¼šÂ¥${zonePrice}`, 'success');
            
            // å…³é—­æ¨¡æ€æ¡†
            document.querySelector('.modal').remove();
        }
        
        // å–æ¶ˆåŒºåŸŸå®šä»·
        function cancelZonePricing() {
            // å–æ¶ˆé€‰æ‹©æ‰€æœ‰åº§ä½
            const svgSeats = document.querySelectorAll('.selected-seat');
            svgSeats.forEach(seat => {
                seat.classList.remove('selected-seat');
                seat.style.fill = '#4CAF50';
            });
            
            const seatMarkers = document.querySelectorAll('.seat-marker.selected');
            seatMarkers.forEach(marker => {
                marker.classList.remove('selected');
                marker.style.backgroundColor = '#4CAF50';
            });
            
            // å…³é—­æ¨¡æ€æ¡†
            document.querySelector('.modal').remove();
        }

        // åŠ è½½ç¤ºä¾‹åº§ä½å›¾
        function loadSampleSeatMap() {
            const seatMap = document.getElementById('seatMap');
            const stage = seatMap.querySelector('.stage');
            
            // æ¸…ç©ºç°æœ‰å†…å®¹ï¼Œä¿ç•™èˆå°
            seatMap.innerHTML = '';
            seatMap.appendChild(stage);
            
            // åˆ›å»ºç¤ºä¾‹åº§ä½åŒºåŸŸ
            const seatSection = document.createElement('div');
            seatSection.className = 'seat-section';
            
            // ç”Ÿæˆ5æ’10åˆ—çš„ç¤ºä¾‹åº§ä½
            for (let row = 1; row <= 5; row++) {
                const seatRow = document.createElement('div');
                seatRow.className = 'seat-row';
                
                for (let col = 1; col <= 10; col++) {
                    const seat = document.createElement('div');
                    seat.className = 'seat available';
                    seat.textContent = `${String.fromCharCode(64 + row)}${col}`;
                    seat.dataset.row = row;
                    seat.dataset.col = col;
                    seatRow.appendChild(seat);
                }
                
                seatSection.appendChild(seatRow);
            }
            
            seatMap.appendChild(seatSection);
            showToast('ç¤ºä¾‹åº§ä½å›¾åŠ è½½æˆåŠŸï¼', 'success');
        }

        // æ¸…é™¤åº§ä½å›¾
        function clearSeatMap() {
            const seatMap = document.getElementById('seatMap');
            const stage = seatMap.querySelector('.stage');
            
            // æ¸…ç©ºæ‰€æœ‰å†…å®¹ï¼Œåªä¿ç•™èˆå°
            seatMap.innerHTML = '';
            seatMap.appendChild(stage);
            
            // æ¸…ç©ºæ–‡ä»¶è¾“å…¥
            document.getElementById('seatMapUpload').value = '';
            showToast('åº§ä½å›¾å·²æ¸…é™¤ï¼', 'success');
        }
    </script>
</body>
</html>